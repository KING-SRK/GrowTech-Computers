<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Voter Card Find</title>
    <link
      rel="stylesheet"
      href="../digital solution css/voter-card-correction.css"
    />
    <link rel="stylesheet" href="../css/popup.css" />

    <link
      href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css"
      rel="stylesheet"
    />

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  </head>
  <body>
    <button class="fixed-back-btn" onclick="history.back()">
      <i class="ri-arrow-left-s-line"></i>
    </button>

    <div class="page-header">
      <h1>Voter Card Find</h1>

      <div class="submit-note Voter-find">
        ğŸ“ <strong>Note:</strong> Fill the exact details below carefully.
      </div>
    </div>

    <div class="box">
      <div class="image-slider">
        <div class="slides">
          <img src="../images/voter-img1.png" alt="Slide 1" />
          <img src="../images/voter-img2.png" alt="Slide 2" />
          <img src="../images/voter-img3.png" alt="Slide 3" />
          <img src="../images/voter-img4.png" alt="Slide 4" />
        </div>
      </div>
      <form id="voter-form">
        <div class="container">
          <div class="info-form">
            <label for="epic">EPIC Number or Reference Number:</label>
            <p style="font-size: 13px; color: #0a3c59; text-align: left">
              If you don't have EPIC Number, you can use Reference Number which
              you get before applying for voter card.
            </p>
            <input
              type="text"
              id="epic"
              name="epic"
              placeholder="Enter EPIC or Reference"
              required
            />

            <label for="name">Enter Your Name:</label>
            <input
              type="text"
              id="name"
              name="name"
              placeholder="Enter Name"
              required
            />

            <label for="phone">Enter Your Mobile Number:</label>
            <input
              type="tel"
              id="phone"
              name="phone"
              placeholder="e.g. 9876543210"
              required
            />

            <label for="email">Enter Your Email ID:</label>
            <input
              type="email"
              id="email"
              name="email"
              placeholder="Enter Email ID"
              required
            />
          </div>
        </div>

        <div class="container" style="margin-top: 20px">
          <p
            style="
              font-size: 16px;
              margin-bottom: 20px;
              color: #0a3c59;
              text-align: center;
            "
          >
            Send the following documents via WhatsApp:
          </p>

          <ul style="color: #0a3c59; margin-left: 25px; font-size: 15px">
            <li>ğŸ“„ Aadhaar Card (Front & Back)</li>
          </ul>
          <div style="text-align: center; margin: 10px 0">
            <a
              href="https://wa.me/918902709631?text=Hi, I submitted my Voter Card Find request. Sending my Aadhar card photo."
              target="_blank"
            >
              <button
                type="button"
                style="
                  padding: 10px 25px;
                  background-color: #25d366;
                  color: white;
                  border: none;
                  border-radius: 8px;
                  font-size: 16px;
                  cursor: pointer;
                "
              >
                ğŸ“¤ Send Photo via WhatsApp
              </button>
            </a>
          </div>

          <label
            style="
              display: flex;
              align-items: center;
              gap: 10px;
              font-size: 15px;
              margin-top: 10px;
            "
          >
            <input type="checkbox" id="photo-confirm" required />
            I confirm that I have sent my Aadhar card photo via WhatsApp.
          </label>
        </div>

        <div class="submit-container">
          <button type="submit">Submit</button>
        </div>
      </form>

      <div
        id="popup-container"
        style="
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.7);
          justify-content: center;
          align-items: center;
          z-index: 9999;
        "
      >
        <div
          style="
            max-width: 700px;
            background: #fff9e6;
            color: #6b4c00;
            font-size: 16px;
            font-weight: 500;
            border: 2px solid #ffdd57;
            border-left: 6px solid #ffc107;
            padding: 20px 25px;
            border-radius: 10px;
            line-height: 1.7;
            text-align: center;
            box-shadow: 0 0 10px rgba(255, 193, 7, 0.2);
            font-family: 'Segoe UI', sans-serif;
          "
        >
          <h2
            id="popup-title"
            style="margin-bottom: 12px; font-size: 22px; color: #5c3a00"
          >
            ğŸ‰ Success
          </h2>
          <p id="popup-message">Your premium message goes here.</p>
          <button
            id="popup-ok-btn"
            style="
              margin-top: 20px;
              padding: 10px 22px;
              background: #ffc107;
              color: #4a3200;
              border: none;
              border-radius: 6px;
              font-size: 15px;
              font-weight: bold;
              cursor: pointer;
              box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
              transition: background 0.3s ease;
            "
          >
            OK
          </button>
        </div>
      </div>
    </div>

    <script>
      // Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyDI8FxDlILMR93AD69_E48qwMKJuSUqFXg",
        authDomain: "digital-solutions-ae7ad.firebaseapp.com",
        databaseURL:
          "https://digital-solutions-ae7ad-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "digital-solutions-ae7ad",
        storageBucket: "digital-solutions-ae7ad.appspot.com",
        messagingSenderId: "761041929019",
        appId: "1:761041929019:web:d228c928c6bd40ea4fed1e",
      };

      firebase.initializeApp(firebaseConfig);
      const database = firebase.database();

      // Show popup function
      function showPopup(title, message) {
        const popupContainer = document.getElementById("popup-container");
        document.getElementById("popup-title").innerText = title;
        document.getElementById("popup-message").innerText = message;
        popupContainer.style.display = "flex";
      }

      // Close popup button event
      document.getElementById("popup-ok-btn").addEventListener("click", () => {
        document.getElementById("popup-container").style.display = "none";
      });

      // Voter form submission handler
      document
        .getElementById("voter-form")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          // Check if the photo confirmation checkbox is checked
          if (!document.getElementById("photo-confirm").checked) {
            showPopup(
              "âš ï¸ Photo Required",
              "â— Please confirm that you have sent your Aadhar card photo via WhatsApp before submitting."
            );
            return;
          }

          // ** Changes to save data by date **
          const today = new Date().toISOString().split("T")[0]; // yyyy-mm-dd

          const formData = {
            epicNumber: document.getElementById("epic").value.trim(),
            name: document.getElementById("name").value.trim(),
            phone: document.getElementById("phone").value.trim(),
            email: document.getElementById("email").value.trim(),
            photoConfirmed: true,
            timestamp: new Date().toISOString(),
          };

          // Push data to Firebase under a date-specific reference
          database
            .ref("voterCardFind/" + today)
            .push(formData)
            .then(() => {
              // Show success popup and reset the form
              showPopup(
                "âœ… Submission Successful",
                "We have received your request. Our team will call you shortly to find your voter card details. Please keep your phone turned on and nearby."
              );
              e.target.reset();
              document.getElementById("photo-confirm").checked = false;
            })
            .catch((error) => {
              // Show error popup if something goes wrong
              showPopup("âŒ Error", "Something went wrong: " + error.message);
            });
        });
    </script>

    <script>
      const slider = document.querySelector(".image-slider");
      const slides = document.querySelector(".slides");
      const images = slides.querySelectorAll("img");

      let currentIndex = 0;
      const totalSlides = images.length;

      // âœ… à¦ªà§à¦°à¦¥à¦® à¦†à¦° à¦¶à§‡à¦· à¦‡à¦®à§‡à¦œ à¦•à¦ªà¦¿ à¦•à¦°à§‡ clone à¦¯à§‹à¦— à¦•à¦°à¦¾ à¦¹à¦šà§à¦›à§‡ (infinite loop effect à¦à¦° à¦œà¦¨à§à¦¯)
      const firstClone = images[0].cloneNode(true);
      const lastClone = images[totalSlides - 1].cloneNode(true);

      slides.appendChild(firstClone); // à¦¶à§‡à¦·à§‡ à¦ªà§à¦°à¦¥à¦® clone
      slides.insertBefore(lastClone, images[0]); // à¦¶à§à¦°à§à¦¤à§‡ à¦¶à§‡à¦· clone

      // à¦¸à¦¬ à¦‡à¦®à§‡à¦œ à¦†à¦¬à¦¾à¦° select à¦•à¦°à§‹ (clone à¦¸à¦¹)
      const allImages = slides.querySelectorAll("img");

      let index = 1; // clone à¦à¦° à¦•à¦¾à¦°à¦£à§‡ à¦†à¦¸à¦² à¦¶à§à¦°à§ à¦¹à¦¬à§‡ index=1
      const slideWidth = images[0].clientWidth;

      slides.style.transform = `translateX(-${index * slideWidth}px)`;

      function moveToNextSlide() {
        index++;
        slides.style.transition = "transform 0.5s ease-in-out";
        slides.style.transform = `translateX(-${index * slideWidth}px)`;

        // clone à¦ à¦—à§‡à¦²à§‡ à¦¸à¦¾à¦¥à§‡ à¦¸à¦¾à¦¥à§‡ à¦†à¦¸à¦² à¦¸à§à¦²à¦¾à¦‡à¦¡à§‡ jump à¦•à¦°à¦¬à§‡
        setTimeout(() => {
          if (index === allImages.length - 1) {
            slides.style.transition = "none";
            index = 1; // à¦†à¦¸à¦² à¦ªà§à¦°à¦¥à¦® à¦‡à¦®à§‡à¦œà§‡ à¦«à¦¿à¦°à¦¬à§‡
            slides.style.transform = `translateX(-${index * slideWidth}px)`;
          }
        }, 500);
      }

      setInterval(moveToNextSlide, 3000);

      // window resize à¦¹à¦²à§‡ height adjust à¦•à¦°à¦¬à§‹
      window.addEventListener("resize", () => {
        slider.style.height = allImages[index].clientHeight + "px";
      });

      // à¦ªà§à¦°à¦¥à¦®à§‡ height set à¦•à¦°à§‹
      slider.style.height = allImages[index].clientHeight + "px";
    </script>
  </body>
</html>
